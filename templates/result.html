<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Plagiarism Report</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
      function toggleDark() {
        document.body.classList.toggle('dark');
        localStorage.setItem("theme", document.body.classList.contains('dark') ? "dark" : "light");
      }

      // Load theme on page load
      window.onload = function() {
        if (localStorage.getItem("theme") === "dark") {
          document.body.classList.add("dark");
        }
      }
    </script>
</head>

<body>

<button class="theme-btn" onclick="toggleDark()">ðŸŒ™</button>

<div class="container">
    <h1>ðŸ“Š Plagiarism Analysis Report</h1>

    <!-- Pie Chart -->
    <canvas id="similarityPie" style="max-width:350px;margin:auto;"></canvas>

    <script type="text/javascript">
      const labels_safe_001 = {{ similarities | map(attribute='doc') | list | tojson }};
      const scores_safe_001 = {{ similarities | map(attribute='score') | list | tojson }};
      const scores_percent_safe_001 = scores_safe_001.map(v => v * 100);

      new Chart(document.getElementById("similarityPie"), {
        type: "pie",
        data: {
          labels: labels_safe_001,
          datasets: [{
            data: scores_percent_safe_001,
            backgroundColor: ["#4a76ff","#ff6384","#36a2eb","#ffcd56","#2ecc71","#e74c3c"]
          }]
        }
      });
    </script>

    <h2>Your Input Text</h2>
    <pre class="input-text">{{ input_text }}</pre>

    <h2>Similarity Scores</h2>
    <ul>
        {% for s in similarities %}
          <li><b>{{ s.doc }}</b> â€” {{ '%.2f'|format(s.score * 100) }}%</li>
        {% endfor %}
    </ul>

    <h2>Highlighted Matches</h2>
    {% for h in highlights %}
      <h3>{{ h.doc }} â€” {{ '%.2f'|format(h.score * 100) }}%</h3>
      <div class="highlight-box">{{ h.highlighted | safe }}</div>
    {% endfor %}

    <div class="center-btn">
      <a href="{{ url_for('download_pdf') }}"><button>ðŸ“„ Download PDF Report</button></a>
      <a href="{{ url_for('index') }}"><button>Check Another</button></a>
    </div>
</div>

</body>
</html>
